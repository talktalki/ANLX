# Stock Price Prediction Using Time Series Forecasting

## Project Overview
- Background: In late January 2021, GameStop (GME), a video game retailer, became the center of a financial phenomenon known as a 'short squeeze.' This occurred when a surge of retail investors, coordinating through social media platforms like Reddit's r/wallstreetbets, began buying up GameStop's stock. This drove up the stock price dramatically, which in turn inflicted heavy losses on hedge funds and other investors who had bet against the stock by short-selling it. The event drew widespread media attention, sparked controversy over stock market practices, and led to hearings in the U.S. Congress.
- Objective: In this project, I build a stock price prediction model (LSTM) incorporating both **historical stock market data and social media sentiment** to predict daily closing prices between June 2021 and August 2021, a total of 90 days.
The LSTM network is specifically designed to capture long-term dependencies and has proven to be effective in time series forecasting tasks. I then evaluate its accuracy on the GameStop short squeeze, and analyze potential improvements based on the event.

## Dataset
- Historical Stock Price: Yahoo Finance (accessed programmatically via yfinance in Python)
  - January 4th, 2021 - August 31st, 2021
- Reddit Sentiment: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/TUMIPC (rGME_dataset_features.csv)
  - January 4th, 2021 - December 31st, 2021

## Part 1: Model Building
1. Time-series forecasting: This model will focus on historical stock price data, employing neural network architectures like LSTMs to capture sequential patterns and long-term dependencies.
2. Sentiment analysis: Uses sentiment scores captured in the rGME_dataset_features.csv dataset. This dataset was analyzed using the Vader module.
3. Model fusion: This model will combine the predictions from both the time-series forecasting and sentiment analysis to perform the final predictions.

## Part 2: Model Training & Evaluation
First, the LSTM model is constructed using historical stock data as the primary feature. Training is conducted using the PyTorch deep learning framework, utilizing the training dataset spanning from January 2021 to May 2021. Following training, the model's performance is assessed using the testing dataset from June 2021 to September 2021. Evaluation metrics, including mean squared error (MSE), root mean squared error (RMSE), and mean absolute error (MAE), are employed to gauge the model's accuracy.<br>
Subsequently, sentiment scores are introduced as an additional feature, augmenting the historical stock data and resulting in a 2D array feature vector. The LSTM model undergoes retraining using this updated feature vector. Comparative analysis of predictions and metrics between the univariate and combined models reveals a noteworthy reduction in error rates with the combined model, signifying its superior performance over the univariate model.

## Part 3: Model Adaptation
In this section, simulated spikes were introduced in social media sentiment to assess the model's performance under conditions similar to the GameStop short squeeze. These simulated spikes had a notable impact on the model's predictions. Specifically, when social media sentiment scores were artificially set to be extremely negative, the model predicted corresponding drops in stock prices. Conversely, when sentiment scores were artificially set to be positive, the model predicted increases in stock prices. This experiment highlights the sensitivity of the model to sudden changes in sentiment, showcasing its ability to adapt to and reflect shifts in market dynamics influenced by social media sentiment.<br>
Based on the sensitivity analysis conducted, several concrete modifications and feature engineering strategies can be proposed to enhance the existing model's performance in capturing the impact of extreme social media sentiment on stock prices. One approach is to implement dynamic sentiment weighting, where the importance of social media sentiment is adjusted based on its extremity. During periods of extreme sentiment spikes, higher weights can be assigned to sentiment features to amplify their influence on the model's predictions. Additionally, introducing temporal features that capture the timing and duration of extreme sentiment spikes could provide valuable context for the model. Features indicating the rate of change in sentiment or the duration of extreme sentiment periods can help differentiate between short-term spikes and sustained trends in sentiment, improving the model's predictive accuracy. Ensemble methods and regularization techniques can also be employed to combine predictions from multiple models and prevent overfitting, respectively, further enhancing the model's performance in capturing extreme social media sentiment's impact on stock prices.

## Part 4: Conclusion and Future Directions
**Key Findings & Discussion**: The assignment evaluated the impact of incorporating social media sentiment data on stock price prediction models. The incorporation of sentiment scores alongside historical stock data in the LSTM model has significantly enhanced its predictive performance. By integrating sentiment analysis, the model gains access to additional information that captures market sentiment, investor behavior, and external factors influencing stock prices. This supplementary data enriches the feature set, providing a more comprehensive and nuanced understanding of market dynamics. The multidimensional feature vector, comprising both historical data and sentiment scores, enables the model to discern subtle patterns and relationships that may not be apparent when using historical data alone. Furthermore, the diversification of features reduces the model's reliance on a single data source, leading to more robust and reliable predictions, particularly in volatile or uncertain market conditions. The improved accuracy of the combined model underscores the importance of incorporating diverse and relevant features in predictive modeling for more informed decision-making in financial markets.
Moreover, the model proved to respond quickly when exposed to simulated spikes in social media sentiment, indicating its sensitivity to extreme events. During the model's training phase, social media sentiment features were likely given considerable importance, enabling the model to learn and recognize patterns associated with extreme sentiment changes. This emphasis on social media sentiment features made the model particularly responsive to variations in these features during the testing phase. Additionally, the model's architecture, particularly its LSTM components, is designed to capture sequential patterns in data and adjust predictions based on new information. This architectural characteristic enhances the model's ability to remember past sentiment trends and react promptly to changes, contributing to its sensitive response to simulated spikes in social media sentiment.

**Future Research Directions**: To improve the performance of stock price prediction models integrating social media sentiment, future research could focus on refining feature engineering processes to better capture the impact of extreme sentiment events. Also, developing advanced machine learning algorithms, such as deep learning models with attention mechanisms, could help improve the models' ability to effectively incorporate and leverage social media sentiment data. Attention mechanisms can help the model focus on important parts of the input data, allowing it to better distinguish between relevant and irrelevant information. Additionally, exploring the use of ensemble methods, such as combining multiple models trained on different subsets of data or using different algorithms, could help improve the robustness and accuracy of the models. Ensemble methods have been shown to be effective in improving the performance of machine learning models in various domains and could similarly benefit stock price prediction models. Finally, future research should also consider potential challenges and ethical considerations associated with using social media sentiment data in stock price prediction. This includes ensuring the transparency of the models and the data sources used, as well as addressing privacy concerns related to the use of personal data in social media mining. By addressing these challenges and continuing to innovate in these areas, future research can help improve the effectiveness and reliability of stock price prediction models that integrate social media sentiment data.

## Packages Used
![PyTorch](https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?style=for-the-badge&logo=PyTorch&logoColor=white)
![scikit-learn](https://img.shields.io/badge/scikit--learn-%23F7931E.svg?style=for-the-badge&logo=scikit-learn&logoColor=white)
![Pandas](https://img.shields.io/badge/pandas-%23150458.svg?style=for-the-badge&logo=pandas&logoColor=white)
![Matplotlib](https://img.shields.io/badge/Matplotlib-%23ffffff.svg?style=for-the-badge&logo=Matplotlib&logoColor=black)
